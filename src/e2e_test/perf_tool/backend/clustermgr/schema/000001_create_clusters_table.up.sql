CREATE TYPE cluster_status AS ENUM ('AVAILABLE', 'INUSE');

CREATE TABLE clusters (
  cid int PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
  -- gke name of the cluster
  name varchar(512) UNIQUE,
  -- kubeconfig is the kubeconfig for this cluster, including its endpoint, and server ca cert.
  kubeconfig bytea,
  -- pixie_cluster_id is the cluster id in pixie cloud assigned to this cluster.
  pixie_cluster_id UUID,
  -- experiment_uuid is the uuid of the experiment assigned to this cluster. If status == AVAILABLE this has no meaning.
  experiment_uuid UUID,
  -- experiment_retry_idx together with experiment_uuid, uniquely identifies a single run of an experiment.
  experiment_retry_idx int,
  -- cleanup_time is updated when the cluster is assigned, and when the runner is given access to the cluster.
  -- its used to cleanup clusters that have been assigned/inuse for too long.
  cleanup_time timestamp,
  -- status of the cluster.
  status cluster_status,
  -- node_pools is json serialized node pools.
  node_pools bytea
);
